<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onetouch.web.brd.dao.BrdMapper">
	<select id="mtrList" resultType="com.onetouch.web.mtr.stck.dao.LotVO">
		SELECT
			a.MTR_CD,
			SUM(a.HLD_CNT) AS HLD_CNT,
			SUM(a.STCK_CNT) AS MTR_STCK_CNT,
			b.SAFE_STCK,
			(SUM(a.STCK_CNT)-SUM(a.HLD_CNT)) AS STCK_USE,
			b.USE_YN,
			FN_GET_MTR_CD_TO_NM(a.MTR_CD) AS MTR_NM,
			FN_GET_BAS_DTL_CD_TO_NM(b.UNIT) AS UNIT_NM,
			FN_GET_BAS_DTL_CD_TO_NM(b.MTR_SECT) AS MTR_SECT_NM
		FROM
			MTR_LOT_STCK a, ADM_MTR b, MTR_IN c
		WHERE
			a.MTR_CD = b.MTR_CD
		AND
			a.IN_NO = c.IN_NO
		GROUP BY
            a.MTR_CD, b.SAFE_STCK, b.USE_YN, FN_GET_BAS_DTL_CD_TO_NM(a.MTR_CD),FN_GET_BAS_DTL_CD_TO_NM(b.UNIT), FN_GET_BAS_DTL_CD_TO_NM(b.MTR_SECT)
		ORDER BY
			MTR_CD
	</select>
	<select id="fctList" resultType="com.onetouch.web.fct.prod.dao.ProdVO">
	<![CDATA[ select a.*,  (to_date(chkExpectDt, 'yyyy-MM-dd') - trunc(sysdate)) as day_diff
			from 
			(SELECT distinct p.fct_cd as fctCd, 
			       p.prod_chk_no as prodChkNo,
			       f.fct_nm as fctNm, 
			       (select max(chk_dt) from fct_prod_chk where chk_dt = p.chk_dt) as chkDt, 
			       p.chk_rslt as chkRslt, 
			       p.msr_mtt as msrMtt, 
			       p.msr_cmt as msrCmt,
			       case when f.chk_prod_unit = 'Y' then to_char(add_months((select max(chk_dt) from fct_prod_chk where chk_dt = p.chk_dt), (f.chk_prod * 12)), 'yyyy-MM-dd')
			            when f.chk_prod_unit = 'M' then to_char(add_months((select max(chk_dt) from fct_prod_chk where chk_dt = p.chk_dt), f.chk_prod), 'yyyy-MM-dd')
			            when f.chk_prod_unit = 'W' then to_char((select max(chk_dt) from fct_prod_chk where chk_dt = p.chk_dt) + (f.chk_prod * 7), 'yyyy-MM-dd')
			            when f.chk_prod_unit = 'D' then to_char((select max(chk_dt) from fct_prod_chk where chk_dt = p.chk_dt) + f.chk_prod, 'yyyy-MM-dd')
			           end as chkExpectDt
			        From fct_prod_chk p, fct_info f
			      WHERE p.fct_cd= f.fct_cd) a
			   where chkExpectDt >= to_char(sysdate, 'yyyy-MM-dd')
			   and chkExpectDt < = to_char(sysdate + 7, 'yyyy-MM-dd')
   	]]>
	</select>
	<select id="pdtList" resultType="com.onetouch.web.prd.prc.dao.PrcVO">
		select * from prd_prc_mng
		where to_date(work_str_dt,'yyyy-MM-dd')=to_date(sysdate,'yyyy-MM-dd')

		--select * from pdt_work_instr_dtl
		--where to_date(work_str_date,'yyyy-MM-dd')=to_date(sysdate,'yyyy-MM-dd')
	</select>
</mapper>