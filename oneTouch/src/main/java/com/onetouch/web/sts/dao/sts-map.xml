<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onetouch.web.sts.dao.StsMapper">

	<!-- 자재입고량 mtrIn =====================================-->
	<!-- 일별 -->
	<select id="mtrInDate" resultType="com.onetouch.web.sts.dao.StsVO">
		SELECT 	 DECODE(GROUPING_ID(IN_DATE,MTR_CD),3,'합계',IN_DATE) AS IN_DATE,
		         DECODE(GROUPING_ID(IN_DATE,MTR_CD),1,IN_DATE||'소계',MTR_CD) AS MTR_CD, 
		         COUNT(MTR_CD) AS CNT
		FROM 	 MTR_IN 
		WHERE	 IN_DATE BETWEEN #{startDate} AND #{endDate}
		GROUP BY ROLLUP(IN_DATE , MTR_CD)
		ORDER BY IN_DATE,DECODE(SUBSTR(MTR_CD,0,1),'M',0)
	</select>
	
	<!-- 월별 -->
	<select id="mtrInMonth" resultType="com.onetouch.web.sts.dao.StsVO">
		SELECT   DECODE(GROUPING_ID(TO_CHAR(IN_DATE, 'YYYY/MM'),MTR_CD),3,'합계',TO_CHAR(IN_DATE, 'YYYY/MM')) AS IN_DATE,
		         DECODE(GROUPING_ID(TO_CHAR(IN_DATE, 'YYYY/MM'),MTR_CD),1,TO_CHAR(IN_DATE, 'YYYY/MM')||'소계',MTR_CD) AS MTR_CD, 
		         COUNT(MTR_CD) AS CNT
		FROM 	 MTR_IN 
		WHERE 	 IN_DATE BETWEEN #{startDate} AND #{endDate}
		GROUP BY ROLLUP(TO_CHAR(IN_DATE, 'YYYY/MM'),MTR_CD)
		ORDER BY IN_DATE,DECODE(SUBSTR(MTR_CD,0,1),'M',0)
	</select>
	
	<!-- 연도별 -->
	<select id="mtrInYear" resultType="com.onetouch.web.sts.dao.StsVO">
		SELECT   DECODE(GROUPING_ID(TO_CHAR(IN_DATE, 'YYYY'),MTR_CD),3,'합계',TO_CHAR(IN_DATE, 'YYYY')) AS IN_DATE,
		         DECODE(GROUPING_ID(TO_CHAR(IN_DATE, 'YYYY'),MTR_CD),1,TO_CHAR(IN_DATE, 'YYYY')||'소계',MTR_CD) AS MTR_CD, 
		         COUNT(MTR_CD) AS CNT
		FROM 	 MTR_IN 
		WHERE 	 IN_DATE BETWEEN #{startDate} AND #{endDate}
		GROUP BY ROLLUP(TO_CHAR(IN_DATE, 'YYYY') , MTR_CD)
		ORDER BY IN_DATE,DECODE(SUBSTR(MTR_CD,0,1),'M',0)
	</select>
	
	<!-- 자재별, 일별 -->
	<select id="mtrInMtrD" resultType="com.onetouch.web.sts.dao.StsVO">
		SELECT   DECODE(GROUPING_ID(MTR_CD, IN_DATE),3,'합계', MTR_CD) AS MTR_CD,
		         DECODE(GROUPING_ID(MTR_CD, IN_DATE),1,MTR_CD||'소계', IN_DATE) AS IN_DATE,
		         COUNT(*) AS CNT
		FROM 	 MTR_IN 
		WHERE 	 IN_DATE BETWEEN #{startDate} AND #{endDate}
		GROUP BY ROLLUP(MTR_CD,IN_DATE)
		ORDER BY MTR_CD
	</select>
	
	<!-- 자재별, 월별 -->
	<select id="mtrInMtrM" resultType="com.onetouch.web.sts.dao.StsVO">
		SELECT   DECODE(GROUPING_ID(MTR_CD, TO_CHAR(IN_DATE, 'YYYY/MM')),3,'합계', MTR_CD) AS MTR_CD,
		         DECODE(GROUPING_ID(MTR_CD, TO_CHAR(IN_DATE, 'YYYY/MM')),1,MTR_CD||'소계', TO_CHAR(IN_DATE, 'YYYY/MM')) AS IN_DATE,
		         COUNT(*) AS CNT
		FROM 	 MTR_IN 
		WHERE 	 IN_DATE BETWEEN #{startDate} AND #{endDate}
		GROUP BY ROLLUP(MTR_CD,TO_CHAR(IN_DATE, 'YYYY/MM'))
		ORDER BY MTR_CD
	</select>
	
	<!-- 자재별, 연도별 -->
	<select id="mtrInMtrY" resultType="com.onetouch.web.sts.dao.StsVO">
		SELECT   DECODE(GROUPING_ID(MTR_CD, TO_CHAR(IN_DATE, 'YYYY')),3,'합계', MTR_CD) AS MTR_CD,
		         DECODE(GROUPING_ID(MTR_CD, TO_CHAR(IN_DATE, 'YYYY')),1,MTR_CD||'소계', TO_CHAR(IN_DATE, 'YYYY')) AS IN_DATE,
		         COUNT(*) AS CNT
		FROM 	 MTR_IN 
		WHERE 	 IN_DATE BETWEEN #{startDate} AND #{endDate}
		GROUP BY ROLLUP(MTR_CD,TO_CHAR(IN_DATE, 'YYYY'))
		ORDER BY MTR_CD
	</select>
	
	<!-- 자재출고량 mtrOut =====================================-->
	<!-- 일별 -->
	<!-- 월별 -->
	<!-- 자재별 -->
	
	<!-- 제품생산량 pdtCnt =====================================-->
	<!-- 일별 -->
	<!-- 월별 -->
	<!-- 제품별 -->
	
	<!-- 제품불량량 fltCnt =====================================-->
	<!-- 일별 -->
	<!-- 월별 -->
	<!-- 제품별 -->
	
</mapper>